<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <div class="wrapper"></div>
    <script>
      //è¿™ä¸€èŠ‚å’Œä¸Šä¸€èŠ‚æœ‰æ‰€é‡å¤ï¼ŒåŸå› æ˜¯ä¸Šä¸€èŠ‚çš„ä»£ç å’Œæ•™ç¨‹ä¸Šçš„ä»£ç ç›¸æ¯”ä»æœ‰å¯ä»¥æ”¹è¿›çš„åœ°æ–¹

      const createDomFromString = function(str) {
        let div = document.createElement("div");
        div.innerHTML = str;
        return div;
      };
      const mount = function(component, wrapper) {
        component.onStateChange = function(oldEl,newEl){
          wrapper.insertBefore(newEl,oldEl)
          wrapper.removeChild(oldEl)
        }
        wrapper.appendChild(component.renderDOM())
      };
      class Component {
        constructor(props = {}) {
          this.props = props;
        }
        setState(newState) {
          let oldEl = this.el;
          this.state = newState;
          this.renderDOM();
          if (this.onStateChange) {
            this.onStateChange(oldEl, this.el);
          }
        }
        renderDOM() {
          this.el = createDomFromString( this.render());
          if(this.onClick){
            this.el.addEventListener('click',this.onClick.bind(this))
          }
          return this.el
        }
      }
      class LikeButton extends Component {
        constructor(props) {
          super(props);
          this.state = {
            isLiked: false
          };
        }
        render() {
          return `
                  <button class='like-btn'>
                    <span class='like-text'>
                      ${this.state.isLiked ? 'å–æ¶ˆ':'ç‚¹èµ'}
                    </span>
                  </button>
                `;
        }
        onClick(){
          this.setState({
            isLiked:!this.state.isLiked
          })
        }
      }

      mount((new LikeButton()),document.querySelector('.wrapper'))

      class LikeButton1 extends Component {
    constructor (props) {
      super(props)
      this.state = { isLiked: false }
    }

    onClick () {
      this.setState({
        isLiked: !this.state.isLiked
      })
    }

    render () {
      return `
        <button class='like-btn' style="background-color: ${this.props.bgColor}">
          <span class='like-text'>
            ${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}
          </span>
          <span>ğŸ‘</span>
        </button>
      `
    }
  }

  mount(new LikeButton1({ bgColor: 'red' }),document.querySelector('.wrapper'))
  //åŸæ¥æ˜¯è¿™æ ·ï¼ŒæŠŠå¸¸é‡è®¾ç½®åœ¨propsä¸­ï¼Œè€Œå˜é‡æ”¾åœ¨stateä¸­ï¼Œæ¯•ç«Ÿåªæœ‰æ”¹å˜state(this.setState)æ‰èƒ½è°ƒç”¨ç»„ä»¶çš„renderDOMå‡½æ•°ã€‚
  //è€Œä¸”è¿™æ ·çš„è¯åœ¨å†™onClickçš„æ—¶å€™ï¼Œthis.setStateè¦æ–¹ä¾¿ä¸€äº›ï¼Œè¯•æƒ³åªæœ‰stateè€Œæ²¡æœ‰propsçš„è¯ï¼Œé‚£stateå°±æœ‰ä¸¤ä¸ªå±æ€§:isLikedå’ŒbgColor
  //è€ŒsetStateçš„æ—¶å€™å°±å¿…é¡»å†å†™ä¸€æ¬¡bgColorçš„å€¼ï¼Œå¦‚æœå±æ€§å¤šèµ·æ¥çš„è¯æ— ç–‘æ›´ç—›è‹¦ï¼Œæ‰€ä»¥è¿™æ ·è®¾è®¡æˆstateå’Œpropsè¿˜æ˜¯æœ‰å¥½å¤„çš„
    </script>
  </body>
</html>
